dynamic analysis emulation malware analysis taint analysis virtualization dynamic analysis is an important technique used in malware analysis and is complementary to static analysis thus far virtualization has been widely adopted for building fine-grained dynamic analysis tools and this trend is expected to continue unlike userkernel space malware analysis platforms that essentially co-exist with malware virtualization based platforms benefit from isolation and fine-grained instrumentation support isolation makes it more difficult for malware samples to disrupt analysis and fine-grained instrumentation provides analysts with low level details such as those at the machine instruction level this in turn supports the development of advanced analysis tools such as dynamic taint analysis and symbolic execution for automatic path explorationthe major disadvantage of virtualization based malware analysis is the loss of semantic information also known as the semantic gap problem to put it differently since analysis takes place at the virtual machine monitor where only the raw system state eg cpu and memory is visible higher level constructs such as processes and files must be reconstructed using the low level information the collection of techniques used to bridge semantic gaps is known as virtual machine introspectionvirtualization based analysis platforms can be further separated into emulation and hardware virtualization emulators have the advantages of flexibility of analysis tool development and efficiency for fine-grained analysis however emulators suffer from the transparency problem that is malware can employ methods to determine whether it is executing in an emulated environment versus real hardware and cease operations to disrupt analysis if the machine is emulated in brief emulation based dynamic analysis has advantages over userkernel space and hardware virtualization based techniques but it suffers from semantic gap and transparency problemsthese problems have been exacerbated by recent discoveries of anti-emulation malware that detects emulators and android malware with two semantic gaps java and native also it is foreseeable that malware authors will have a similar response to taint analysis in other words once taint analysis becomes widely used to understand how malware operates the authors will create new malware that attacks the imprecisions in taint analysis implementations and induce false-positives and false-negatives in an effort to frustrate analyststhis dissertation addresses these problems by presenting concepts methods and techniques that can be used to transparently and precisely analyze both desktop and mobile malware using virtualization this is achieved in three parts first precise heterogeneous record and replay is presented as a means to help emulators benefit from the transparency characteristics of hardware virtualization this technique is implemented in a tool called v2e that uses kvm for recording and temu for replaying and analysis it was successfully used to analyze real-world anti-emulation malware that evaded analysis using temu alone second the design of an emulation based android malware analysis platform that uses virtual machine introspection to bridge both the java and native level semantic gaps as well as seamlessly bind the two views together into a single view is presented the core introspection and instrumentation techniques were implemented in a new analysis platform called droidscope that is based on the android emulator it was successfully used to analyze two real-world android malware samples that have cooperating java and native level components taint analysis was also used to study their information ex-filtration behaviors third formal methods for studying the sources of false-positives and false-negatives in dynamic taint analysis designs and for verifying the correctness of manually defined taint propagation rules are presented these definitions and methods were successfully used to analyze and compare previously published taint analysis platforms in terms of false-positives and false-negatives